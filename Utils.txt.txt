Utility functions of version 3